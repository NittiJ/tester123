library(tidyverse)
library(openxlsx)

# Load the datasets
California <- readRDS("path/to/California.RDS")
OLD_California <- readRDS("path/to/OLD_California.RDS")

# Compare the total differences
new_providers <- anti_join(California, OLD_California, by = "ORG_NPI")
dropped_providers <- anti_join(OLD_California, California, by = "ORG_NPI")

# Print the differences
total_new <- nrow(new_providers)
total_dropped <- nrow(dropped_providers)

# Export to Excel
wb <- createWorkbook()
addWorksheet(wb, "New Providers")
writeData(wb, "New Providers", new_providers)
addWorksheet(wb, "Dropped Providers")
writeData(wb, "Dropped Providers", dropped_providers)
saveWorkbook(wb, "California_HMO_Comparison.xlsx", overwrite = TRUE)

# Print summary
cat("California Total New Providers: ", total_new, "\n")
cat("California Total Dropped Providers: ", total_dropped, "\n")



# Load the datasets
Colorado <- readRDS("path/to/Colorado.RDS")
OLD_Colorado <- readRDS("path/to/OLD_Colorado.RDS")

# Compare the total differences
new_providers <- anti_join(Colorado, OLD_Colorado, by = "NPI")
dropped_providers <- anti_join(OLD_Colorado, Colorado, by = "NPI")

# Print the differences
total_new <- nrow(new_providers)
total_dropped <- nrow(dropped_providers)

# Export to Excel
wb <- createWorkbook()
addWorksheet(wb, "New Providers")
writeData(wb, "New Providers", new_providers)
addWorksheet(wb, "Dropped Providers")
writeData(wb, "Dropped Providers", dropped_providers)
saveWorkbook(wb, "Colorado_HMO_Comparison.xlsx", overwrite = TRUE)

# Print summary
cat("Colorado Total New Providers: ", total_new, "\n")
cat("Colorado Total Dropped Providers: ", total_dropped, "\n")


# Load the datasets
Nevada <- readRDS("path/to/Nevada.RDS")
OLD_Nevada <- readRDS("path/to/OLD_Nevada.RDS")

# Compare the total differences
new_providers <- anti_join(Nevada, OLD_Nevada, by = "NPI")
dropped_providers <- anti_join(OLD_Nevada, Nevada, by = "NPI")

# Print the differences
total_new <- nrow(new_providers)
total_dropped <- nrow(dropped_providers)

# Export to Excel
wb <- createWorkbook()
addWorksheet(wb, "New Providers")
writeData(wb, "New Providers", new_providers)
addWorksheet(wb, "Dropped Providers")
writeData(wb, "Dropped Providers", dropped_providers)
saveWorkbook(wb, "Nevada_HMO_Comparison.xlsx", overwrite = TRUE)

# Print summary
cat("Nevada Total New Providers: ", total_new, "\n")
cat("Nevada Total Dropped Providers: ", total_dropped, "\n")




# Load the datasets
Vision <- readRDS("path/to/Vision.RDS")
OLD_Vision <- readRDS("path/to/OLD_Vision.RDS")

# Compare the total differences
new_providers <- anti_join(Vision, OLD_Vision, by = "NPI")
dropped_providers <- anti_join(OLD_Vision, Vision, by = "NPI")

# Print the differences
total_new <- nrow(new_providers)
total_dropped <- nrow(dropped_providers)

# Export to Excel
wb <- createWorkbook()
addWorksheet(wb, "New Providers")
writeData(wb, "New Providers", new_providers)
addWorksheet(wb, "Dropped Providers")
writeData(wb, "Dropped Providers", dropped_providers)
saveWorkbook(wb, "Vision_HMO_Comparison.xlsx", overwrite = TRUE)

# Print summary
cat("Vision Total New Providers: ", total_new, "\n")
cat("Vision Total Dropped Providers: ", total_dropped, "\n")





